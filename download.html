<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Download Files</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    * {
      box-sizing: border-box;
      font-family: 'Roboto', sans-serif;
      margin: 0;
      padding: 0;
    }

    body {
  background-color: #fff9e6;
  min-height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 20px;
}
.wrapper {
  width: 100%;
  max-width: 1400px;
  display: flex;
  justify-content: center;
}

.container {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(500px, 1fr));
  gap: 20px;
  justify-items: center; /* Center each card in its grid cell */
}


.card {
  width: 100%;
  max-width: 500px;
  background: rgb(255, 250, 235);
  box-shadow:
    0 187px 75px rgba(0, 0, 0, 0.01),
    0 105px 63px rgba(0, 0, 0, 0.05),
    0 47px 47px rgba(0, 0, 0, 0.09),
    0 12px 26px rgba(0, 0, 0, 0.1),
    0 0 0 rgba(0, 0, 0, 0.1);
  border-radius: 19px;
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

.card-header {
  text-align: center;
  font-size: 16px;
  font-weight: bold;
  background: #f7e6b5;
  padding: 15px;
  border-bottom: 1px solid #ddd;
}

    .file-list {
  display: flex;
  flex-direction: column;
  overflow-y: auto;
  max-height: 350px; /* Increase height for bigger list view */
  padding: 15px;
  gap: 10px;
}

.file-item {
  display: flex;
  align-items: center;
  justify-content: space-between;
  background-color: rgb(251, 243, 228);
  padding: 10px;
  border-radius: 8px;
  border: 1px dashed rgba(16, 86, 82, 0.5);
}

    .file-name {
  font-size: 13px;
  font-weight: 500;
  max-width: 300px; /* Expanded name space */
  overflow: hidden;
  white-space: nowrap;
  text-overflow: ellipsis;
}

    button.download-btn {
      background-color: rgba(16, 86, 82, 0.15);
      border: none;
      border-radius: 8px;
      padding: 5px 10px;
      font-size: 12px;
      font-weight: 600;
      color: #000;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    button.download-btn:hover {
      background-color: rgba(16, 86, 82, 0.25);
    }

    @media (max-width: 768px) {
      .container {
        grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
      }
    }
  </style>
</head>
<body>

<div id="downloadList" class="container">
  <p id="waitingText" style="grid-column: 1 / -1; text-align: center;">Waiting for files...</p>
</div>

<script src="/socket.io/socket.io.js"></script>
<script src="webrtc.js"></script>
<script>
  initReceiver();

  function addDownloadBatch(batchFiles) {
    const container = document.getElementById('downloadList');
    const waitingText = document.getElementById('waitingText');
    if (waitingText) waitingText.remove();

    const card = document.createElement('div');
    card.className = 'card';

    const header = document.createElement('div');
    header.className = 'card-header';
    header.textContent = 'YOUR FILES ARE READY';

    const fileList = document.createElement('div');
    fileList.className = 'file-list';

    batchFiles.forEach(({ filename, blob }) => {
      const fileItem = document.createElement('div');
      fileItem.className = 'file-item';

      const nameSpan = document.createElement('span');
      nameSpan.className = 'file-name';
      nameSpan.textContent = filename;
      nameSpan.title = filename; // Full filename on hover

      const downloadBtn = document.createElement('button');
      downloadBtn.className = 'download-btn';
      downloadBtn.textContent = 'Download';
      downloadBtn.onclick = () => {
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = filename;
        a.click();
        URL.revokeObjectURL(url);
      };

      fileItem.appendChild(nameSpan);
      fileItem.appendChild(downloadBtn);

      fileList.appendChild(fileItem);
    });

    card.appendChild(header);
    card.appendChild(fileList);

    container.appendChild(card);
  }
</script>

</body>
</html>
